import{f as M,a2 as y,ao as J,c as d,a,d as C,a1 as x,t as g,g as E,F as A,r as D,a4 as W,o as l,X as $,m as K,_ as ee,i as te,u as re,j as ne,l as oe,k as e}from"./DHhi54m_.js";import{T as ie}from"./Dp121xVt.js";import{p as ae}from"./BH6hjzg9.js";import{_ as _e}from"./BheWnx7M.js";const le={class:"flex absolute left-10 text-[8em] font-extrabold text-white/60 items-end"},de={class:"grid grid-cols-4 absolute top-50 left-10 w-160 gap-1"},se={class:"flex flex-col gap-0"},ue=["onClick","onTouchstart"],me={class:"bg-gray-100/30 rounded-full p-[1px] border border-1 border-white/50"},pe=["src","alt"],ce={class:"text-white/50"},fe={class:"grid grid-cols-4 absolute top-50 left-60 w-160 gap-1"},ge={class:"flex flex-col gap-0"},Ee=["onClick","onTouchstart"],Te={class:"bg-gray-100/30 rounded-full p-[1px] border border-1 border-white/50"},Le={class:"text-white/50"},ye={class:"text-[1.1em] no-wrap font-bold"},Ae=["href"],De={style:{width:"110px",height:`${110*1.5}px`}},Pe=["src"],Ie={class:"flex flex-wrap gap-[3px] w-[45px] absolute top-7 right-0"},Re=["src"],je={class:"flex flex-wrap -gap-[3px] text-sm w-[45px] absolute bottom-1 right-0"},Ve={class:"rounded-full p-[1px] outline-normal cursor-default"},O=200,k=230,xe=M({__name:"MapContainer",props:{mapData:{}},setup(u){const s=y(null),T=y(null);let p={},L=[],I=[],m=y("");function f(r,t){console.log("toggleSelect",r,t),m.value==r?m.value="":m.value=r,L.forEach(n=>{n.drop.card.key==m.value?n.ele.classList.add("blinking-outline"):n.ele.classList.remove("blinking-outline")}),I.forEach(n=>{n.animal==m.value?n.ele.classList.add("blinking-outline"):n.ele.classList.remove("blinking-outline")})}let b=2e3,h=2e3,v=0,w=0;function N(){let r=u.mapData.places,t=Number.MAX_VALUE,n=Number.MAX_VALUE,o=Number.MIN_VALUE,_=Number.MIN_VALUE;r.forEach(i=>{i.position.x>1e4||(i.position.x<t&&(t=i.position.x),i.position.y<n&&(n=i.position.y),i.position.x>o&&(o=i.position.x),i.position.y>_&&(_=i.position.y))}),b=(o-t+1)*O,h=(_-n+1)*k,v=-t*O+100,w=-n*k+100}N(),y([{x:100,y:100},{x:-50,y:200},{x:300,y:-80},{x:-200,y:-100}]);function F(){return u.mapData.places.filter(r=>r.position.x<1e3)}function P(r){return{left:r.position.x*O+v,top:r.position.y*k+w}}function B(){return u.mapData.places.flatMap(t=>t.dropFilter).map(t=>t.card).filter((t,n,o)=>o.findIndex(_=>_.key==t.key)==n)}function z(r){const t=r.getBoundingClientRect();return{top:t.top+window.scrollY,left:t.left+window.scrollX}}const S=[{key:"Partridge",text:"灰山鹑",icon:"🦃"},{key:"Rodent",text:"松鼠",icon:"🐿️"},{key:"Badger",text:"獾",icon:"🦡"},{key:"Fox",text:"狐狸",icon:"🦊"},{key:"Doe",text:"鹿",icon:"🦌"},{key:"Boar",text:"野猪",icon:"🐗"},{key:"Wolf",text:"狼",icon:"🐺"}];function X(r){return S.filter(t=>r.animals[t.key])}J(()=>{s.value&&(H(),U())});function H(){ae(s.value,{maxZoom:5,minZoom:.5,zoomSpeed:.065,bounds:!0})}function U(){const r=document.createElement("script");r.src="/leader-line.min.js",document.body.appendChild(r),r.onload=()=>{Y()}}function Y(){LeaderLine.positionByWindowResize=!1;const r=z(s.value);u.mapData.travelPaths.forEach(n=>{let o=p[n.from.key],_=p[n.to.key];if(o&&_){let i=u.mapData.places.find(V=>V.card.key==n.from.key),c=u.mapData.places.find(V=>V.card.key==n.to.key);P(i),P(c),new LeaderLine(o,_,{color:n.toway?"#829844":"rgb(180, 152, 68)",startPlug:n.toway?"arrow1":"behind",startPlugSize:1,endPlugSize:1,size:n.toway?2:3,startSocket:["top","bottom","right","left"][n.direction],...n.toway?{endSocket:["bottom","top","left","right"][n.direction]}:{startSocketGravity:c.position.y==i.position.y?[0,100]:void 0,endSocket:c.position.x>i.position.x?"left":"right"},endPlug:"arrow1",path:n.toway?"straight":"fluid",dash:!n.toway})}}),document.querySelectorAll(".leader-line").forEach(n=>{s.value.appendChild(n),n.style.transform=`translate(${-r.left+8}px, ${-r.top}px)`})}function q(r,t){r&&(p[t.card.key]=r,r.style.backgroundColor=t.backgroundType=="cave"?"#3a3a3a":t.backgroundType=="river"?"#085a80":"#016630")}function G(r,t){r&&L.push({drop:t,ele:r})}function Z(r,t){r&&I.push({animal:t,ele:r})}let R=y("全年");const j=[{key:"all",label:"全年",color:"#193d22"},{key:"spring",label:"春季",color:"#0a2b14"},{key:"summer",label:"夏季",color:"#2a5b3d"},{key:"autumn",label:"秋季",color:"#3b1d0a"},{key:"winter",label:"冬季",color:"#1b3a5a"}];function Q(){let r=j[(j.findIndex(t=>t.label==R.value)+1)%j.length];R.value=r.label,T.value.style.backgroundColor=r.color,Object.keys(p).forEach(t=>{let o=p[t].querySelector("img"),_=u.mapData.places.find(i=>i.card.key==t);_.seasonArts[r.key]?o.src=`/Sprite/${_.seasonArts[r.key].FileName}.png`:o.src=`/Sprite/${_.card.icon}.png`}),L.forEach(t=>{if(t.ele.classList.remove("outline-more"),t.ele.classList.remove("outline-less"),t.ele.classList.remove("outline-none"),t.ele.classList.add("outline-normal"),r.key=="all")return;let n=t.drop.seasonFilter[r.key];n==2?t.ele.classList.add("outline-less"):n==3?t.ele.classList.add("outline-more"):n==0?t.ele.classList.add("outline-none"):n==1&&t.ele.classList.add("outline-normal")})}return(r,t)=>{const n=ie;return l(),d("div",{class:"container text-white",ref_key:"container",ref:T},[a("div",{ref_key:"map",ref:s,class:"map",style:W({width:`${E(b)}px`,height:`${E(h)}px`})},[a("div",le,[a("span",null,[t[0]||(t[0]=C("奇幻森林 ")),x((l(),d("span",{class:"text-4xl cursor-pointer",onClick:Q},[C(g(E(R)),1)])),[[n,"点击切换季节",void 0,{bottom:!0}]])])]),t[1]||(t[1]=a("div",{class:"flex absolute left-70 top-500 text-[5em] font-extrabold text-white/60 items-end"},[a("span",null,"洞穴系统")],-1)),t[2]||(t[2]=a("div",null,null,-1)),a("div",de,[a("div",se,[(l(!0),d(A,null,D(B(),(o,_)=>(l(),d("div",{key:_,class:$(["p-2 flex gap-x-1 rounded-lg transition-all duration-200 cursor-pointer",{"bg-yellow-100/50":E(m)===o.key}]),onClick:i=>f(o.key,"drop"),onTouchstart:i=>f(o.key,"drop")},[a("div",me,[a("img",{src:`/Sprite/${o.icon}.png`,alt:o.text+"???",class:"w-5 h-5 object-contain dropImg"},null,8,pe)]),a("span",ce,g(o.text),1)],42,ue))),128))])]),a("div",fe,[a("div",ge,[(l(),d(A,null,D(S,(o,_)=>a("div",{key:_,class:$(["p-2 flex gap-x-1 rounded-lg transition-all duration-200 cursor-pointer h-10",{"bg-yellow-100/50":E(m)===o.key}]),onClick:i=>f(o.key,"animal"),onTouchstart:i=>f(o.key,"animal")},[a("div",Te,[a("span",null,g(o.icon),1)]),a("span",Le," : "+g(o.text),1)],42,Ee)),64))])]),(l(!0),d(A,null,D(F(),(o,_)=>(l(),d("div",{key:_,ref_for:!0,ref:i=>q(i,o),class:"absolute p-1 bg-green-800 rounded-lg",style:W({left:`${P(o).left}px`,top:`${P(o).top}px`,width:`${o.backgroundType=="cave"?120:165}px`})},[a("div",ye,[a("a",{href:`/${o.card.key}`},g(o.card.text),9,Ae)]),a("div",De,[o.card.icon?(l(),d("img",{key:0,class:"w-full h-full object-contain",src:`/Sprite/${o.card.icon}.png`},null,8,Pe)):K("",!0)]),a("div",Ie,[(l(!0),d(A,null,D(o.dropFilter,i=>(l(),d("div",{ref_for:!0,ref:c=>G(c,i),class:"rounded-full p-[1px] outline-normal"},[x(a("img",{src:`/Sprite/${i.card.icon}.png`,class:"w-4 h-4 object-contain dropImg"},null,8,Re),[[n,i.card.text,void 0,{bottom:!0}]])],512))),256))]),a("div",je,[(l(!0),d(A,null,D(X(o),i=>x((l(),d("div",{ref_for:!0,ref:c=>Z(c,i.key)},[a("div",Ve,g(i.icon),1)])),[[n,i.text,void 0,{bottom:!0}]])),256))])],4))),128))],4),t[3]||(t[3]=a("div",{class:"controls"},null,-1)),t[4]||(t[4]=a("div",{class:"leftbottom"},[a("div")],-1))],512)}}}),Oe=Object.assign(ee(xe,[["__scopeId","data-v-3faac141"]]),{__name:"MapContainer"}),we=M({__name:"GameMap",props:{id:{}},async setup(u){let s,T;const p=u,{mapData:L}=([s,T]=te(()=>_e(Object.assign({"../../generated/CardType0.json":()=>e(()=>import("./BmE8eUIp.js"),[],import.meta.url),"../../generated/CardType1.json":()=>e(()=>import("./xYScU5az.js"),[],import.meta.url),"../../generated/CardType10.json":()=>e(()=>import("./Daf5kFUg.js"),[],import.meta.url),"../../generated/CardType11.json":()=>e(()=>import("./9xyIOZQg.js"),[],import.meta.url),"../../generated/CardType12.json":()=>e(()=>import("./BwDrqd8x.js"),[],import.meta.url),"../../generated/CardType13.json":()=>e(()=>import("./_okQPiap.js"),[],import.meta.url),"../../generated/CardType2.json":()=>e(()=>import("./DXjVboAD.js"),[],import.meta.url),"../../generated/CardType3.json":()=>e(()=>import("./hZOAtl0z.js"),[],import.meta.url),"../../generated/CardType4.json":()=>e(()=>import("./BhRroz-P.js"),[],import.meta.url),"../../generated/CardType5.json":()=>e(()=>import("./CNKpEcif.js"),[],import.meta.url),"../../generated/CardType6.json":()=>e(()=>import("./pNXiHtQO.js"),[],import.meta.url),"../../generated/CardType7.json":()=>e(()=>import("./-mWNecwe.js"),[],import.meta.url),"../../generated/CardType8.json":()=>e(()=>import("./ys4cDerr.js"),[],import.meta.url),"../../generated/CardType9.json":()=>e(()=>import("./C-HlGWfW.js"),[],import.meta.url),"../../generated/EncounterSystem.json":()=>e(()=>import("./DZLyjyFC.js"),[],import.meta.url),"../../generated/EnemyList.json":()=>e(()=>import("./Bmchp4Sa.js"),[],import.meta.url),"../../generated/EquipmentTag.json":()=>e(()=>import("./BsIhn1Yy.js"),[],import.meta.url),"../../generated/FlavourSystem.json":()=>e(()=>import("./CUQ7hxt0.js"),[],import.meta.url),"../../generated/FlavourTag.json":()=>e(()=>import("./DFoWh1ur.js"),[],import.meta.url),"../../generated/Map.json":()=>e(()=>import("./CwqqU-uc.js"),[],import.meta.url),"../../generated/Perk.json":()=>e(()=>import("./Dbd-vpqq.js"),[],import.meta.url),"../../generated/Quest.json":()=>e(()=>import("./YRUlMqQK.js"),[],import.meta.url),"../../generated/SpiceTag.json":()=>e(()=>import("./2SvphSzK.js"),[],import.meta.url),"../../generated/Trigger.json":()=>e(()=>import("./Cq1c41MN.js"),[],import.meta.url),"../../generated/WeaponMove.json":()=>e(()=>import("./CAOEPTT1.js"),[],import.meta.url),"../../generated/_Ammo.json":()=>e(()=>import("./BSLbgHu_.js"),[],import.meta.url),"../../generated/_Armor.json":()=>e(()=>import("./DQ7gkNUk.js"),[],import.meta.url),"../../generated/_BlueprintIndex.json":()=>e(()=>import("./Bl8bC-ud.js"),[],import.meta.url),"../../generated/_Container.json":()=>e(()=>import("./0GV2hiO3.js"),[],import.meta.url),"../../generated/_Food.json":()=>e(()=>import("./CPrg9DdQ.js"),[],import.meta.url),"../../generated/_NPCIndex.json":()=>e(()=>import("./Ci9sl2Pd.js"),[],import.meta.url),"../../generated/_Seasons.json":()=>e(()=>import("./CCLm2Eea.js"),[],import.meta.url),"../../generated/_StatIndex.json":()=>e(()=>import("./CA-wSdt6.js"),[],import.meta.url),"../../generated/_TradingValue.json":()=>e(()=>import("./qxpqQFhO.js"),[],import.meta.url),"../../generated/_Weapon.json":()=>e(()=>import("./CAPJYMfO.js"),[],import.meta.url),"../../generated/eTag_Backpack.json":()=>e(()=>import("./BFmarDy9.js"),[],import.meta.url),"../../generated/eTag_Belt.json":()=>e(()=>import("./B4en1g1l.js"),[],import.meta.url),"../../generated/eTag_Bracers.json":()=>e(()=>import("./GNDZyEGi.js"),[],import.meta.url),"../../generated/eTag_Hands.json":()=>e(()=>import("./2TeAQrE_.js"),[],import.meta.url),"../../generated/eTag_Head.json":()=>e(()=>import("./Dzz-07jS.js"),[],import.meta.url),"../../generated/eTag_Mask.json":()=>e(()=>import("./DpZlceM1.js"),[],import.meta.url),"../../generated/eTag_Neck.json":()=>e(()=>import("./C0hEShJQ.js"),[],import.meta.url),"../../generated/eTag_OuterTorso.json":()=>e(()=>import("./Bfgd98Qk.js"),[],import.meta.url),"../../generated/eTag_Pants.json":()=>e(()=>import("./B6cm_DCv.js"),[],import.meta.url),"../../generated/eTag_Pouch.json":()=>e(()=>import("./DjmmSD6-.js"),[],import.meta.url),"../../generated/eTag_Shield.json":()=>e(()=>import("./SAf0wSyi.js"),[],import.meta.url),"../../generated/eTag_Shirt.json":()=>e(()=>import("./3iCTRjA6.js"),[],import.meta.url),"../../generated/eTag_Shoes.json":()=>e(()=>import("./Bg-gGsoK.js"),[],import.meta.url),"../../generated/eTag_Shoulder.json":()=>e(()=>import("./BIg9VI2_.js"),[],import.meta.url),"../../generated/eTag_Spirit.json":()=>e(()=>import("./BfMz4ng9.js"),[],import.meta.url),"../../generated/eTag_WAbrasion.json":()=>e(()=>import("./CLjtXaVv.js"),[],import.meta.url),"../../generated/eTag_WArmFractureL.json":()=>e(()=>import("./DhVA3GZ2.js"),[],import.meta.url),"../../generated/eTag_WArmFractureR.json":()=>e(()=>import("./BUHSmSPI.js"),[],import.meta.url),"../../generated/eTag_WArmLacerationL.json":()=>e(()=>import("./D0R6Ts36.js"),[],import.meta.url),"../../generated/eTag_WArmLacerationR.json":()=>e(()=>import("./CGZ2DPsN.js"),[],import.meta.url),"../../generated/eTag_WArmSprainedL.json":()=>e(()=>import("./BaTbi19N.js"),[],import.meta.url),"../../generated/eTag_WArmSprainedR.json":()=>e(()=>import("./BBfmzCTc.js"),[],import.meta.url),"../../generated/eTag_WBite.json":()=>e(()=>import("./B_3K3tEw.js"),[],import.meta.url),"../../generated/eTag_WLegFractureL.json":()=>e(()=>import("./DU7sSxO9.js"),[],import.meta.url),"../../generated/eTag_WLegFractureR.json":()=>e(()=>import("./Tz-oTwb6.js"),[],import.meta.url),"../../generated/eTag_WLegLacerationL.json":()=>e(()=>import("./ZTMG81-9.js"),[],import.meta.url),"../../generated/eTag_WLegLacerationR.json":()=>e(()=>import("./Cf8rQj3A.js"),[],import.meta.url),"../../generated/eTag_WLegSprainedL.json":()=>e(()=>import("./DSA7JsNa.js"),[],import.meta.url),"../../generated/eTag_WLegSprainedR.json":()=>e(()=>import("./f2re6b2l.js"),[],import.meta.url),"../../generated/eTag_WMinorWound.json":()=>e(()=>import("./CHqkl3Ib.js"),[],import.meta.url),"../../generated/eTag_WRibFracture.json":()=>e(()=>import("./g7gpYexP.js"),[],import.meta.url),"../../generated/eTag_WSpiritual.json":()=>e(()=>import("./DIQGNy6m.js"),[],import.meta.url),"../../generated/encounterPopup.json":()=>e(()=>import("./CazpAx3n.js"),[],import.meta.url),"../../generated/searchData.json":()=>e(()=>import("./BOjftXkE.js"),[],import.meta.url)}),`../../generated/${p.id}.json`,4)),s=await s,T(),s).default;return re({title:`游戏地图 - ${ne().$gameName}`}),(I,m)=>{const f=Oe;return l(),oe(f,{mapData:E(L)},null,8,["mapData"])}}});export{we as default};
